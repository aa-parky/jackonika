<!doctype html>
<meta charset="utf-8" />
<title>Jackonika ↔ Backplanika demo</title>
<link rel="stylesheet" href="../dist/jackonika_style.css" />
<div id="jack"></div>
<pre id="log" style="padding:12px;border:1px solid #ccc;max-height:240px;overflow:auto"></pre>

<script src="../dist/jackonika.iife.js"></script>
<script src="../rack/backplanika.iife.js"></script>
<script>
  const jack = Jackonika.create("#jack", { channel: "omni" });

  // Simple log sink with the required 'emit(e)' shape:
  const logEl = document.querySelector("#log");
  const logSink = { emit(e) {
	logEl.textContent = JSON.stringify(e) + "\n" + logEl.textContent;
  }};

  // One‑liner patch:
  const unplug = Backplanika.connect(jack.output, logSink);

  // Example: filter/map inline
  // const unplug = Backplanika.connect(jack.output, logSink, {
  //   filter: (e) => e.type === "noteon",
  //   map:    (e) => ({ ...e, ts: Date.now() }),
  //   thru:   (e) => console.debug("thru:", e),
  // });
</script>